{include file="public/header" /}
<body>
<div class="x-body layui-anim layui-anim-up">
  <form class="layui-form" action="/sys/source/update" method="post" enctype="multipart/form-data">
<!--     <div class="layui-form-item">
        <label class="layui-form-label xbs768">资源类型</label>
        <div class="layui-input-inline">
          <select name="source_type" lay-verify="" lay-search="" >
            <option value="">直接选择或搜索选择</option>
            {volist name="source_type" key="k" id="v"}
            <option value="{$k}"
                    {if condition="isset($list['source_type']) and  $k eq $list.source_type"} selected="selected" {/if}>{$v}</option>
            {/volist}
          </select>
        </div>
    </div>     -->

    <div class="layui-form-item">
      <label class="layui-form-label">资源上传</label>
      <div class="layui-upload">
        <div style="float: left; width: 150px; text-align: center;">
          <button type="button" class="layui-btn" id="img">点击上传</button>
          <div class="layui-upload-list">
            <img class="layui-upload-img" id="img1" width="150" src="{$list['file_path']|default=''}">
          </div>
        </div>
      </div>
    </div>
    
    <input type="hidden" name="fid" value="{$list.fid|default=''}">
    <input type="hidden" name="file_path" id="FImageUrl" value="{$list['file_path']|default=''}">
    <div class="layui-form-item">
      <label class="layui-form-label xbs768">状态</label>
      <div class="layui-input-block">
        <input type="radio" name="record_status" value="1" title="启用" {if condition="isset($list['record_status']) and $list['record_status'] eq 1 "}checked {/if}>
        <input type="radio" name="record_status" value="2" title="禁用" {if condition="isset($list['record_status']) and $list['record_status'] eq 2"} checked {/if}>
        <input type="radio" name="record_status" value="-1" title="标记删除" {if condition="isset($list['record_status']) and  $list['record_status'] eq -1"} checked {/if}>
      </div>
    </div>
    <div class="layui-form-item">
      <label class="layui-form-label"></label>
      <button class="layui-btn" lay-filter="save" lay-submit="" type="submit">保存</button>
    </div>
  </form>
</div>
<script>
  layui.use('upload',function(){
    var $ = layui.jquery
    ,upload = layui.upload;
    var fid='{$list.fid|default=0}';
    var source_type='{$list.source_type|default=0}';
    //上传
    var uploadInst = upload.render({
      elem: '#img'
      ,url: '/upload'
      ,data: {fid:fid,source_type:source_type}
      ,accept: 'file'
      ,before: function(obj){
        obj.preview(function(index, file, result){
          $('#img1').attr('src', result);
        });
      }
      ,done: function(res){
        //如果上传失败
        console.log(res);
        if(res.code==200){
          $('#FImageUrl').attr('value', res.data);
          return layer.msg('上传成功');
        }else{
          return layer.msg('上传失败');
        }
      }
    });
  });
</script>
</body>
</html>